library(foreign)
library(VIM)
library(missMDA)
library(naniar)
#library(poLCA)
library("FactoMineR")
library("factoextra")
dataset = read.spss("dateframe/NBH2013_Public_Use.sav",to.data.frame = TRUE,stringsAsFactors = FALSE)
dataset = dataset[,!sapply(dataset, function(x) mean(is.na(x)))>0.99]
dataset = subset(dataset,select = -c(stratum,psu))
summary(dataset)
dim(dataset)
df <- dataset[-c(3:58,112:121)] 
levels(df$Q1) <- c(levels(df$Q1),11,12,13,14,15,16,17,18)
levels(df$Q2) <- c(levels(df$Q2),1,2)
df$Q1 <-replace(df$Q1,df$Q1=="11 years old or younger",11)
df$Q1 <-replace(df$Q1,df$Q1=="12 years old",12)
df$Q1 <-replace(df$Q1,df$Q1=="13 years old",13)
df$Q1 <-replace(df$Q1,df$Q1=="14 years old",14)
df$Q1 <-replace(df$Q1,df$Q1=="15 years old",15)
df$Q1 <-replace(df$Q1,df$Q1=="16 years old",16)
df$Q1 <-replace(df$Q1,df$Q1=="17 years old",17)
df$Q1 <-replace(df$Q1,df$Q1=="18 years old or older",18)
df$Q2 <-replace(df$Q2,df$Q2=="Female",2)
df$Q2 <-replace(df$Q2,df$Q2=="Male",1)
df$QN47 <-replace(df$QN7,df$QN7 == 1,0)
df$QN47 <-replace(df$QN7,df$QN7 == 2,1)
df$QN47 <-replace(df$QN7,df$QN7 == 0,2)
df$QN47 <-replace(df$QN8,df$QN8 == 1,0)
df$QN47 <-replace(df$QN8,df$QN8 == 2,1)
df$QN47 <-replace(df$QN8,df$QN8 == 0,2)
df$QN47 <-replace(df$QN47,df$QN47 == 1,0)
df$QN47 <-replace(df$QN47,df$QN47 == 2,1)
df$QN47 <-replace(df$QN47,df$QN47 == 0,2)
df$QN48 <-replace(df$QN48,df$QN48 == 1,0)
df$QN48 <-replace(df$QN48,df$QN48 == 2,1)
df$QN48 <-replace(df$QN48,df$QN48 == 0,2)
df$QN49 <-replace(df$QN49,df$QN49 == 1,0)
df$QN49 <-replace(df$QN49,df$QN49 == 2,1)
df$QN49 <-replace(df$QN49,df$QN49 == 0,2)
df$QN51 <-replace(df$QN51,df$QN51 == 1,0)
df$QN51 <-replace(df$QN51,df$QN51 == 2,1)
df$QN51 <-replace(df$QN51,df$QN51 == 0,2)
df$QN54 <-replace(df$QN54,df$QN54 == 1,0)
df$QN54 <-replace(df$QN54,df$QN54 == 2,1)
df$QN54 <-replace(df$QN54,df$QN54 == 0,2)
df$QN55 <-replace(df$QN55,df$QN55 == 1,0)
df$QN55 <-replace(df$QN55,df$QN55 == 2,1)
df$QN55 <-replace(df$QN55,df$QN55 == 0,2)
df$QN56 <-replace(df$QN56,df$QN56 == 1,0)
df$QN56 <-replace(df$QN56,df$QN56 == 2,1)
df$QN56 <-replace(df$QN56,df$QN56 == 0,2)
df$QN57 <-replace(df$QN57,df$QN57 == 1,0)
df$QN57 <-replace(df$QN57,df$QN57 == 2,1)
df$QN57 <-replace(df$QN57,df$QN57 == 0,2)
df[df == 2] <- as.character(2)
df[df == 1] <- as.character(1)
res.impute <- imputeMCA(df, ncp=50) 
df <- res.impute$completeObs
write.csv(df,"/home/elina/Documents/thesis/mca_df.csv", row.names = FALSE)
